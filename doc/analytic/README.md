# Хде-Йа - Аналитика

Меня часто спрашивают, зачем это устройство, оно же большое, используется не самый энергоэффективный чип.

Да, у этого устройства много проблем, сложностей. Однако, мне сильно не хватало GPS-навигатора для нужд контроля своей позиции под парашютом. При этом я хотел совместить в нём ряд удобств, которых мне всегда не хватало в дорогих высотниках от крупных известных брендов.

Сейчас я нахожусь на рубеже принятия решения, что дальше делать с этим проектом:

* Если оно окажется интересным для пользователей при всех его текущих проблемах, это будет мотивировать меня к дальнейшей разработке и устранению проблем.
* Среди парашютистов я встречал довольно много инженеров, которые пытались и пытаются изготавливать какие-то свои устройства (высотники, пищалки и т.п.) для нашей деятельности. Может для них этот проэкт поможет этим людям в их разработках.
* Может, кто-то захочет присоединиться к этому проекту. Я открыт для взаимодействия и не планирую оставлять только единоличное право на его ведение.
* Может кто-то из инструкторов подкинет какие-либо идеи, как это можно использовать в обучении.

Однако, если окажется, что проект, кроме меня, больше никому не интересен, скорее всего, на этом его развитие остановиться, а я направлю свои силы в другие идеи.


## Текущие возможности и Области применения

Основные аргументы, побудившие к реализации данного проекта:

* Дороговизна современных GPS/GLONASS-решений в качестве возвращалки.
* Желание синхронизировать логбук с внешним миром, задолбался руками вести учёт прыжков.
* Желание иметь потенциальную возможность допрограммировать устройство.

Все остальные фишки - уже скорее следствие.

* Можно использовать для купольного пилотирования (разбор точности при заходе на приземлении и режимов работы купола).
* Можно доработать какую-то свою функцию в готовое железо и использовать её.
* Мне пригождалось в качестве комфортного контроля точки выброски.
* Можно проконтролировать свои навыки ориентирования на местности с высоты (точность определения нахождения точки относительно себя самого).


## Проблемы

### 1. Уровень приёма внутри ЛА

    Ищу способы решения, нужна помощь знающих радиолюбителей.

### 2. Энергосбережение

Половину ёмкости аккумулятора отъёдает микропроцессор приёма GPS/GLONASS-сигнала. Если его отключать, когда он не нужен, это позволит существенно продлить время работы до ближайшей зарядки.

Схема и чип выбраны тоже не самые эффективные.

### 3. Стабильность распознавания начала свободного падения

Начало прыжка чаще всего определяется с точностью до 2-3 секунд. Но вот не всегда принимается верное решение, было ли свободное падение или это раскрытие под бортом.

Выражается проблема в нулевом времени свободного падения.

Тут пока нет достаточной статистики. В этом может помочь каждый - присылайте свои треки прыжков. А если приложете ещё и видео прыжка - это тоже сильно поможет.

### 4. Объём места для треков

Внутри используемого чипа используется довольно большая flash-память. Однако, её недостаточно, чтобы хранить треки более, чем для 3-6 прыжков. При достаточной заинтересованности проектом дальнейшее развитие предполагает использование внешней SD-карты.

Возможно, было ошибкой, рассчитывать на внутреннюю память без использования SD-карты с самого начала. Но так проект проще, компактнее и при этом имеет рабочую форму.

### 5. Подвисания при автоматическом старте трека

Примерно через 5-8 секунд после отделения от ЛА (в момент принятия решения, что начался прыжок) устройство подвисает и не реагирует ни на что несколько секунд.

Происходит это из-за старта записи трека. Именно в начале прыжка на flash-память пишется трек за прошедшие 10 секунд, чтобы прыжок записался с самого начала. Именно это приводит к подвисанию.

Это известная проблема, не решённая пока что программным образом. Скорее всёго, со временем проблема будет решена, а пока что её надо иметь ввиду.

Костыльно сейчас её можно решить выставлением в настройках высоты, на которой запись трека будет стартовать автоматически ещё в подъёме. Это удлинит объём записываемого за один прыжок трека (меньше треков влезет), но это позволит включить трек до начала прыжка и так же автоматически выключить при приземлении. При этом подвисаний при начале прыжка уже не будет.

### 6. Отсутствие аппаратного компаса.

В существующих аппаратных модификациях определение сторон света происходит только по текущему направлению движения. И компас отображается на экране так, будто мы движемся всегда в направлении, перпендикулярном верхней грани корпуса устройства.

Такой подход вполне комфортен при движении внутри ЛА. Однако под парашютом такой способ навигации весьма затруднителен в понимании, хоть и используется во многих сущействующих возвращалках.

Установить аппаратный компас в устройство - уже является одной из запланированных задач на ближайшие аппаратные проработки.


## Выбранный чип

Сейчас в качестве центрального микроконтроллера используется чипсет [`esp32 wroom`](https://www.espressif.com/en/products/modules/esp32). Он много, где, применяется в разработках устройств умного дома, поэтому широко известен за свою простоту в использовании.

Причины, по которым изначально выбран именно этот чип:

* Хороший опыт работы с этим микроконтроллером
* Наличие WiFi и BlueThooth на борту
* Большой объём RAM и ROM памяти
* Простота программирования
* Широкое использование среди начинающих программистов микроконтроллеров из-за низкого порога вхождения

Всё это позволяет минимизировать затраты на разработку.

Однако, есть и минусы:

* Большие габариты
* Высокое энергопотребление
* Пока ещё сырое SDK от разработчиков чипа, особенно в области низкого энергопотребления и WiFi/BlueTooth


## Идеи на будущее

* Сменить чип на более энергоэффективный

    Это потянет за собой необходимость прорабатывать уже протестированное и отлаженное. Например WiFi. Всё это муторно и долго, поэтому требует мотивации. В первую очередь мотивация подкрепляется заинтересованностью общественности в данном проекте.

* Внешняя SD-карта

    Уже давно напрашивается, и в новых аппаратных версиях она точно будет.

* Мобильное приложение и синхронизация по bluetouth

    Тут ещё больше проблем, чем при смене чипа. Идея очень нужная в реализации, но это всё не быстро.
    
    Но при этом не будет требоваться обновления аппаратной модификации на новую. Текущие версии устройств с новыми прошивками гипотетически заработают без проблем.

* Помощь в программах обучения (пилотирование и т.п.)

    На данный момент это уже возможно, если в прыжке использовать устройство как запись трека, а на замле производить разбор. На практике в таком амплуа оно ещё не проверялось и не отлаживалось.
    
    Так же, в какой-то будущей перспективе можно снабжать устройство звуковой сигнализацией. Например, по аналогии с FlySight.


## Стоимость и Изготовление

Пока нет планов выходить на коммерческий конвеер.

#### На данный момент план-предложение такое:

* собираю под заказ до 10 устройств (бесплатно! возможно, попрошу Вас оплатить пересылку)
* в ответ ожидаю максимально подробный фидбек (обратную связь, отзывы, пожелания, диагностика)
* если есть желание задонатить - я не против, сумма любая (отсутствие донатов никакне отменяет всего остального тут сказанного, наличие донатов - в значительной степени мотивирует дальнейшую разработку)
* все, кто из этих 10 человек активно участвовал в видбеке, получит в обмен на старый - прибор следующей аппаратной версии бесплатно (возможно, попрошу Вас оплатить пересылку)
* всё под чесное слово

Собираю я сам вручную. Профессиональным монтажником не являюсь, качество пайки можете оценить по фото.

Сибестоимость устройства: . И продолжает расти при нынешней инфляции и росте курса доллара.

Если готовы учавствовать бета-тестером, для заказа - [контакты](../../README.md#Контакты).

__Для заказа укажите:__

* кто Вы и как к Вам обращаться
* как с Вами связываться
* какую [модификацию](../models/README.md) хотите (две в одни руки делаю только если прям будете реально обе тестировать, а не чтобы сравнить пощупать)
* делать ли [доработки по антенне](antenna.md)
* делать ли [доработки по компасу](compas.md)


Дальнейшие после тестирования планы - пока не определены.
