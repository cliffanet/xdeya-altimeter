# Хде-Йа - Исходники

## Открытость проекта

Проект полностью открыт. Закрывать не планирую. На коммерческую основу ставить - так же не планирую.

Как минимум, для этого потребуются согласования по использованию в этом проекте исходного кода других разработчиков, а так же сертификация использования GPS/GLONASS-приёмника и трекера.


## Можно ли использовать исходники в своих проектах

Да, никаких возражений против использования исходного кода в своих проектах. Однако, будет лучше, если вы будете ссылаться на использование данного проекта. Это один из важных мотивационных факторов к дальнейшему развитию.

Это относится и к любительским проектам, и к крупным бесплатным, и к коммерческим.


## Как прошить с помощью программатора


### Подключение к компьютеру (версия v.0.3)

Вам потребуется переходник USB-to-UART, т.к. в устройстве его нет. Подойдёт любой с AliExpres.

На плате устройства есть вот такой разъём:

* `gnd` - к `GND` переходника.
* `3v3` - к выходу питания `+3.3v` переходника. Этот вывод можно и не подключать, а питать устройство от аккумулятора или через разъём MicroUSB.
* `tx` - к `RX` переходника.
* `rx` - к `TX` переходника.

При подключении переходника USB-to-UART к компьютеру в списке устройств должен появиться новый последовательный порт (COM-порт). Если этого не произошло, скорее всего, необходимо установить драйверы для этого переходника.

Для программирования данного устройства его надо перевести в download-режим. Для этого удерживая кнопку `boot` на плате устройства, нажмите и отпустите кнопку `reset`. После этого можно отпускать кнопку `boot`.

Теперь устройство готово к загрузке на него прошивки.


### Подключение к компьютеру (версия v.0.4)

У этой модификации на борту уже есть переходник USB-to-UART, поэтому для подключения к компьютеру достаточно подключить его кабелем через разъём MicroUSB на устройстве.

При подключении устройства к компьютеру через USB-кабель, в списке устройств должен появиться новый последовательный порт (COM-порт). Если этого не произошло, потребуется установить драйвер для чипа CP2102 под вашу операционную систему.

Теперь устройство готово к загрузке на него прошивки.

### Загрузка прошивки на устройство

* Берём готовые файлы прошивки.

* Дополнительные файлы прошивки.

* Скачиваем и запускаем Flash Download Tools.

* Нажимаем кнопку ESP32

* Указываем 4 файла и адреса к ним:

    * `bootloader.bin` - адрес 0x1000
    * `partitions.bin` - адрес 0x8000
    * `boot_app0.bin` - адрес 0xe000
    * основной файл прошивки - адрес 0x10000

* Ставим галку DoNotChnBin.

* Выбираем COM-порт, через который подключено устройство.

* BAUD : Это скорость, на которой будет заливаться прошивка. Должна работать любоя, в т.ч. максимальная. Но может оказаться, что при высоких скоростях запись будет прерываться.

* Жмем кнопку `START`

После этого начнётся процесс заливки прошивки.

Для аппаратной версии v.0.3 для запуска устройства после заливки прошивки требуется нажать кнопку `reset`.

Для аппаратной версии v.0.4 ничего дополнительно не требуется.


## Как собрать исходный код у себя

### Используемые сторонние библиотеки для среды Arduino

* 

### В среде Arduino

* Откройте в Arduino файл xdeya-altimeter.ino
* В файл def.h

### С помощью arduino-cli

* необходимо 
